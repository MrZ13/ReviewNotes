[TOC]

# Chap3 网络层

## 3.0 本章目标

> - 了解网络层服务背后的原理
>   - 网络层服务模型
>   - 转发与寻路
>   - 路由器如何工作
>   - 寻路(路径选择)
>   - 规模的控制
>   - 新的主题:IPv6和流动性
> - 网络层相关的例子和实现



## 3.1 介绍

### 3.1.1 网络层简介

- 将报文段(Segment)从发送主机传输到接收主机
- 发送主机将报文段封装成数据包
- 在接收主机处，接收主机将数据报中的报文段交给传输层
- 网络层协议在每一个主机和路由器处生效
- 路由器检查每个经过它的IP数据包的头信息





### 3.1.2 网络层的主要功能

- 转发(范围较小)

  将packet从路由器的input处移动到合适的output处

- 寻路(范围较大)

  确定packet从发送处到接收处的路线



### 3.1.3 数据层与控制层

###### 数据层 Data Plane

> - 局部的，路由器的内部的功能
> - 决定datagram如何从路由器的输入端口转发到输出端口

![dBivgs.jpg](https://s1.ax1x.com/2020/08/23/dBivgs.jpg)



###### 控制层 Control Plane

> - 网络范围内的逻辑
> - 决定datagram如何选择合适的路由器，经过端到端的路径前往目的主机
> - 控制层的两种不同实现方式
>   - 传统的寻路算法
>     - 在路由器上实现
>   - 软件定义网络(Software-Defined networking)
>     - 在远程服务器上实现
>
> 
>
> **单一路由器控制层**
>
> ​	每个路由器上的路由算法组件在控制层上进行交互
>
> <img src="https://s1.ax1x.com/2020/08/23/dBAVn1.jpg" alt="dBAVn1.jpg" style="zoom:67%;" />
>
> 
>
> **逻辑集中控制层**
>
> 一个独特的远端控制器与路由器上的CA(Control Agents)进行交互，进行寻路
>
> <img src="https://s1.ax1x.com/2020/08/23/dBkz7V.jpg" alt="dBkz7V.jpg" style="zoom:67%;" />







### 3.1.4 网络层服务模型

网络层服务模型，即决定datagram如何从发送者传输到接收者的服务模型



##### 举例

###### 对于单一datagram的服务

> - 保证交付
> - 保证在一定时长内交付



###### 对于连续datagram流(datagram的有序序列)的服务

> - 有序交付
> - 保证流的最小带宽
> - ......

![dBepr9.jpg](https://s1.ax1x.com/2020/08/23/dBepr9.jpg)





## 3.2 虚拟电路与数据包网络

### 3.2.1 网络层提供的两种服务：无连接的/连接的服务

###### 虚拟电路

> 认为应该由网络层负责可靠的交互，提供有连接的服务



###### 数据包网络

> 网络层向上只提供简单灵活的，无连接的，尽最大努力交付的数据报服务



Tips：网络层提供的服务与传输层有一定的相似之处，区别在于：

1. 端到端的(host to host)：从发送主机到接收主机
2. 无选择的：网络层选择一种提供方式，上层无法决定
3. 实现位置：在网络核心中实现



### 3.2.2 虚拟电路(Virtual Circuit)

> “从起点到终点的路径必须向电话线路一样(可靠)”



#### 3.2.2.1 特点与要求



#### 3.2.2.2 虚拟电路的实现



#### 3.2.2.3 转发表



#### 3.2.2.4 虚拟电路的协议：Signaling Protocols





### 3.2.3 数据包网络(Datagram Network)

> 





### 3.2.4 为什么数据报网络在Internet中得到广泛使用

> 主要取决于Internet网络和终端的特点





### 3.2.5 虚拟电路网络和数据报网络的对比

![dB8Xj0.jpg](https://s1.ax1x.com/2020/08/23/dB8Xj0.jpg)





## 3.3 路由器内部有什么？





## 3.4 IP:Internet Protocol





## 3.5 寻路协议 





## 3.6 Internet中的寻路 





## 3.7 广播与多播寻路 







## 3.8 Internet控制信息协议 







## 3.9 网络管理与SNMP

