[TOC]

# chap2.链接层与局域网(LAN)

## 本章内容：

> 1. 理解链接层的原则
> 2. 理解链接层提供的服务
>    - 错误检测与错误改正
>    - 共享信道：多路访问
>    - 链路层寻址(Mac地址)
>    - 可靠数据传输的实现与流控制
> 3. 不同链路层技术的例子与实现



## 2.1 介绍，以及链接层的服务

### 2.1.1 链路层术语

> :zap:链路层的责任，是将datagram通过链接传输到相邻的节点处



###### Node 节点

> 主机与路由器是链路层上的节点



###### 链接 link

> 链接两个相邻节点的通信通道称为链接



###### 帧 frame

> 链路层上传输的数据单元为帧(frame)，它将网络层的数据包(datagram)进一步封装，加上了头部与尾部





### 2.1.2 frame的传输

- datagram在不同类型的链接上，由不同的协议控制进行传输
- 不同的链接协议提供了不同的服务



### :fire:2.1.3 链路层提供的服务

1. #### 组帧(Framing),获取链接

   - 将datagram封装为frame，加上了头部和尾部
   - 如果媒介是共享的，则需要提供频道的获取
   - 在frame的头部中,MAC地址被用于确定source和destination

   

2. #### 相邻节点之间的可靠传输

   - 此功能在低错误率的传输链接中很少被用到(比如fiber，部分双绞线等)
   - 在高错误率的链接中会被使用(比如无线连接)

   

3. #### 流控制

   - 平衡发送节点和接收节点两处的速率

   

4. #### 错误检测

   - 错误可能是由于信号衰减、噪音等原因导致的
   - 错误由==接受节点==进行检测
     - 要求发送节点重新传输帧/直接抛弃这一帧

   

5. #### 错误改正

   - 接收节点检测到错误后，改正错误，不要求重新进行帧的传输

    

6. #### 半双工与全双工

   - 两种的区别略



### 2.1.4 适配器(Adapters)

[![ddJRjf.md.jpg](https://s1.ax1x.com/2020/08/22/ddJRjf.md.jpg)](https://imgchr.com/i/ddJRjf)

- 链路层在网卡处被实现(常见的适配器就是网卡:Network Interface Card)
- 发送端：
  - 封装
  - 加上错误检测位，流控制，......
- 接收端：
  - 寻找错误，流控制，......
  - 抽取出datagram，如果有需要，再次进行封装，传输给下一个node
- 适配器是半自动的
- 适配器工作在==链路层与物理层==上



## 2.2 错误检测与错误改正

### 2.2.1 错误检测与改正位(Error Detection and Correction Bits : EDC)

###### EDC

> 在正常的数据后加上EDC，是为了接收端检验数据是否正确

![ddYoqO.jpg](https://s1.ax1x.com/2020/08/22/ddYoqO.jpg)



！：错误检测并不是100%可靠的

​	

### 2.2.2 错误检测方法

#### 2.2.2.1 奇偶校验

> 奇[偶校验](https://baike.baidu.com/item/偶校验)(Parity Check)是一种校验代码传输正确性的方法。根据被传输的一组[二进制代码](https://baike.baidu.com/item/二进制代码/4879654)的数位中“1”的个数是奇数或偶数来进行校验。采用奇数的称为[奇校验](https://baike.baidu.com/item/奇校验/1684279)，反之，称为偶校验。采用何种校验是事先规定好的。通常专门设置一个[奇偶校验位](https://baike.baidu.com/item/奇偶校验位/8953123)，用它使这组代码中“1”的个数为奇数或偶数。若用奇校验，则当接收端收到这组代码时，校验“1”的个数是否为奇数，从而确定传输代码的正确性。



<img src="https://s1.ax1x.com/2020/08/22/ddtkJs.jpg" alt="ddtkJs.jpg" style="zoom: 67%;" />



#### 2.2.2.2 网络校验和

> Internet CheckSum是一个==传输层==的错误检测方法

做法：

1.待校验的相邻字节成对组成16比特整数并计算其和的二进制反码(二进制反码求和).
2.生成校验和,校验和区域本身应当先置0,并和待校验数据相加,其和进行二进制反码运算后赋给校验和区域.
3.检查校验和,将所有字节,包括校验和,进行相加并求二进制反码.如果结果为全1(即二进制反码算术中的0),检查通过.

二进制反码求和:从低位到高位逐列进行和计算,如果最高位(16位)进位,则得到的结果加1,一直循环到最高位没有进位为止.最后把得到的结果取反.



#### 2.2.2.3 循环冗余检测(难点，非重点)

- 将数据部分D视为二进制数字
- 校验码部分的长度为r
- 确定一个预先设定的数字r+1位的整数G
- 确定满足要求的r位数字，填入到校验码部分
- 在实践中被广泛使用



## :fire:2.3 多种访问协议

### 2.3.1 多种的链接类型与协议

#### 2.3.1.1 链接类型

> 链路层的链接主要分为两种类型
>
> 1. Point-To-Point
>    - 拨号的链接使用PPP协议控制
>    - 在以太网交换机与主机之间使用点到点链接的以太网
> 2. Broadcast
>    - 传统的以太网
>    - 802.11 无线局域网
>    - ......



#### 2.3.1.2 多种协议的作用

###### 背景

> 对于广播网络中的频道，如果有不少于两个的同时发生的数据传输请求，就会发生碰撞，导致数据出现错误



###### 作用

- 不同的协议中的算法确定节点共享频道的方式
- 使用频道本身达成这个目的(不使用额外的资源)



#### 2.3.1.3 理想的多路访问协议

理想的多路访问协议应该具有如下特点：

假设广播频道的速率为R

1. 如果一个节点想要传输数据，传输速率应该能够达到R
2. 当M个节点想要传输数据，平均传输速率应该能够达到R/M
3. 应该是去中心的
   - 不需要一个特定的节点来协调数据的传输
   - 不需要时钟信号的同步
4. 应该是简单的



### 2.3.2 MAC协议(Multiple Access Control Protocol)

#### 2.3.2.1 MAC协议的分类

1. 信道划分类型
   - 将信道继续向下划分为更小的部分(通过)
   - 为节点分配独有的部分
   - 不会出现冲突
2. 随机访问类型
   - 信道不会划分，允许出现冲突
   - 出现冲突后解决冲突
3. 轮流类型
   - 节点轮流使用，但需要发送更多信息的节点可以使用更长的时间



#### 2.3.2.2 信道划分类型MAC协议

##### 2.3.2.2.1 TDMA

> Time Division Multiple Access 时分多址

与第一章中介绍的TDM基本一致，按照节点个数划分时间片，每个节点在自己的时间片传输数据



##### 2.3.2.2.1 FDMA

> Frequency Division Multiple Access 频分多址

同样，与FDM基本一致，每个节点在自己的频率发送数据



#### 2.3.2.3 随机访问类型MAC协议

> 当节点需要传输数据时，直接传输
>
> - 传输速率可以达到满速R
> - 节点之间没有优先级的区别



##### 2.3.2.3.1 Slotted Aloha

##### 2.3.2.3.2 Pure Aloha(unslotted)

##### 2.3.2.3.3 CSMA

##### 2.3.2.3.4 CSMA/CD



#### 2.3.2.4 轮流类型MAC协议

##### 2.3.2.4.1 Polling

##### 2.3.2.4.2 Token Passing



#### 2.3.2.5 MAC协议的总结





## 2.4 寻址

### 2.4.1 MAC地址

### 2.4.2 ARP(Address Resolution Protocol)

#### 2.4.2.1 ARP的介绍

#### 2.4.2.2 同一个LAN中的寻路

#### 2.4.2.3 不同LAN中的寻路 



## 2.5 以太网(Ethernet)

### 2.5.1 以太网的介绍(第51页PPT放这里)

### 2.5.2 拓扑结构

### 2.5.3 以太网帧的结构

### 2.5.4 以太网与CSMA/CD

#### 2.5.4.1 介绍

#### 2.5.4.2 以太网CSMA/CD算法

#### 2.5.4.3 以太网的效率

### 2.5.5 其他概念

#### 2.5.5.1 10BaseT与100BaseT

#### 2.5.5.2 Hubs(交换机)

#### 2.5.5.3 Gbits以太网







## 2.6 互联设备：集线器与交换机

### 2.6.1 集线器Hubs

#### 2.6.1.1 集线器简介

#### 2.6.2.2 54321规则



### 2.6.2 交换机Switches

#### 2.6.2.1 交换机简介



###### 网桥

> 交换机是简化的网桥

#### 2.6.2.2 交换机的功能与特点

###### 转发

###### 自学习

###### 过滤/转发



#### 2.6.2.3 交换的例子



#### 2.6.2.4 交换机的其他特点

##### 2.6.2.4.1 交通隔离(Traffic Isolation)

##### 2.6.2.4.2 专属访问

##### 2.6.2.4.3  直通交换



#### 2.6.2.5 交换机与路由器的对比



### 2.6.3 总结与对比





## 2.7 PPP协议(Point to Point Protocol)

### 2.7.1 PPP协议的介绍

### 2.7.2 PPP协议的设计要求

### 2.7.3 PPP协议不涉及的要求

### 2.7.4 PPP协议的帧格式

#### 2.7.4.1 各字段的意义

#### 2.7.4.2 字节填充

### 2.7.5 PPP数据控制协议







## 2.8 虚拟连接:ATM:atm:与MPLS

> ATM:Asynchronous Transfer Mode 异步传递方式
>
> MPLS:MultiProtocol Label Switching 多协议标记交换